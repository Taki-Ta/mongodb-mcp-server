# å“åº”æ—¥å¿—è®°å½•åŠŸèƒ½ä½¿ç”¨ç¤ºä¾‹

## å¿«é€Ÿå¼€å§‹

### 1. å¯ç”¨å“åº”æ—¥å¿—è®°å½•

```bash
# å¯ç”¨è¯·æ±‚å“åº”æ—¥å¿—è®°å½•
export MDB_MCP_REQUEST_LOGGING_ENABLED=true
export MDB_MCP_REQUEST_LOGGING_RETENTION_DAYS=7
export MDB_MCP_REQUEST_LOGGING_INCLUDE_HEADERS=true
export MDB_MCP_REQUEST_LOGGING_INCLUDE_BODY=true

# å¯åŠ¨MCPæœåŠ¡å™¨
node dist/index.js
```

### 2. æŸ¥çœ‹æ—¥å¿—ç»Ÿè®¡

```bash
# æŸ¥çœ‹è¯·æ±‚å“åº”ç»Ÿè®¡ä¿¡æ¯
npm run logs:request:stats
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
ğŸ“Š è¯·æ±‚å“åº”æ—¥å¿—ç»Ÿè®¡ä¿¡æ¯:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“ è¯·æ±‚æ–‡ä»¶æ•°: 25 (125.34 KB)
ğŸ“ å“åº”æ–‡ä»¶æ•°: 23 (87.21 KB)
ğŸ“Š æ€»è¯·æ±‚æ•°: 25
ğŸ“Š æ€»å“åº”æ•°: 23
ğŸ’¾ æ€»å¤§å°: 212.55 KB

ğŸ”§ è¯·æ±‚æ–¹æ³•ç»Ÿè®¡:
  tools/call: 20
  tools/list: 3
  resources/list: 2

ğŸ“… æŒ‰æ—¥æœŸç»Ÿè®¡:
  2024-12-28: 15
  2024-12-27: 10

â±ï¸ æ‰§è¡Œæ—¶é—´ç»Ÿè®¡:
  å¹³å‡æ‰§è¡Œæ—¶é—´: 156.43ms
  æœ€å¤§æ‰§è¡Œæ—¶é—´: 1250ms
  æœ€å°æ‰§è¡Œæ—¶é—´: 15ms
```

### 3. æŸ¥çœ‹æœ€è¿‘çš„è¯·æ±‚å“åº”å¯¹

```bash
# æŸ¥çœ‹æœ€è¿‘5ä¸ªè¯·æ±‚å“åº”å¯¹
npm run logs:request:recent
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
ğŸ“‹ æœ€è¿‘ 5 ä¸ªè¯·æ±‚å“åº”å¯¹:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ• 2024/12/28 ä¸‹åˆ2:30:25
ğŸ†” è¯·æ±‚ID: abc12345def67890
ğŸ”§ æ–¹æ³•: tools/call
ğŸ–¥ï¸ å®¢æˆ·ç«¯: vscode-mcp@1.0.0
âœ… å“åº”çŠ¶æ€: âœ… æˆåŠŸ
â±ï¸ æ‰§è¡Œæ—¶é—´: 234ms
ğŸ“¦ è¯·æ±‚ä½“: {"jsonrpc":"2.0","id":"request-1","method":"tools/call","params":{"name":"find","arguments":{"collection":"users","filter":{"status":"active"}}}}...
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

### 4. æŸ¥çœ‹ç‰¹å®šè¯·æ±‚çš„å®Œæ•´ä¿¡æ¯

```bash
# æŸ¥çœ‹ç‰¹å®šè¯·æ±‚IDçš„å®Œæ•´è¯·æ±‚-å“åº”å¯¹
npm run logs:request:pair abc12345def67890
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
ğŸ“‹ è¯·æ±‚-å“åº”è¯¦æƒ…:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“¤ è¯·æ±‚ä¿¡æ¯:
{
  "timestamp": "2024-12-28T14:30:25.123Z",
  "requestId": "abc12345def67890",
  "method": "tools/call",
  "headers": {
    "transport": "StdioServerTransport",
    "timestamp": "2024-12-28T14:30:25.123Z",
    "sessionId": "session123"
  },
  "body": {
    "jsonrpc": "2.0",
    "id": "request-1",
    "method": "tools/call",
    "params": {
      "name": "find",
      "arguments": {
        "collection": "users",
        "filter": { "status": "active" }
      }
    }
  },
  "clientInfo": {
    "name": "vscode-mcp",
    "version": "1.0.0"
  }
}
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“¥ å“åº”ä¿¡æ¯:
{
  "timestamp": "2024-12-28T14:30:25.234Z",
  "requestId": "abc12345def67890",
  "responseData": {
    "jsonrpc": "2.0",
    "id": "request-1",
    "result": {
      "content": [
        {
          "type": "text",
          "text": "[{\"_id\": \"user1\", \"name\": \"John\", \"status\": \"active\"}]"
        }
      ]
    }
  },
  "executionTimeMs": 234
}
```

### 5. æœç´¢ç‰¹å®šå†…å®¹

```bash
# æœç´¢åŒ…å«é”™è¯¯çš„è¯·æ±‚æˆ–å“åº”
npm run logs:request:search "error"

# æœç´¢ç‰¹å®šå·¥å…·è°ƒç”¨
npm run logs:request:search "find"

# æœç´¢ç‰¹å®šçŠ¶æ€
npm run logs:request:search "INVALID_PARAMS"
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
ğŸ” æ‰¾åˆ° 3 ä¸ªåŒ¹é…çš„æ—¥å¿—:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“¥ response - response_2024-12-28_14-31-02_def67890.json
ğŸ• 2024/12/28 ä¸‹åˆ2:31:02
ğŸ†” è¯·æ±‚ID: def67890abc12345
â±ï¸ æ‰§è¡Œæ—¶é—´: 15ms
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

## å¸¸è§ä½¿ç”¨åœºæ™¯

### æ€§èƒ½è°ƒè¯•

1. æŸ¥çœ‹æ‰§è¡Œæ—¶é—´åˆ†å¸ƒï¼š
```bash
npm run logs:request:stats
```

2. æŸ¥æ‰¾æ…¢æŸ¥è¯¢ï¼š
```bash
npm run logs:request:search "executionTimeMs"
```

### é”™è¯¯åˆ†æ

1. æŸ¥æ‰¾æ‰€æœ‰é”™è¯¯å“åº”ï¼š
```bash
npm run logs:request:search "error"
```

2. åˆ†æç‰¹å®šé”™è¯¯ï¼š
```bash
npm run logs:request:search "INVALID_PARAMS"
```

### åŠŸèƒ½ä½¿ç”¨åˆ†æ

1. æŸ¥çœ‹æœ€å¸¸ç”¨çš„å·¥å…·ï¼š
```bash
npm run logs:request:stats  # æŸ¥çœ‹æ–¹æ³•ç»Ÿè®¡
```

2. æŸ¥çœ‹ç‰¹å®šå·¥å…·çš„ä½¿ç”¨æƒ…å†µï¼š
```bash
npm run logs:request:search "find"
npm run logs:request:search "aggregate"
```

### æ¸…ç†æ—§æ—¥å¿—

```bash
# æ¸…ç†7å¤©å‰çš„æ—¥å¿—
npm run logs:request:cleanup

# æ¸…ç†3å¤©å‰çš„æ—¥å¿—
npm run logs:request cleanup 3
```

## æµ‹è¯•åŠŸèƒ½

è¿è¡Œæµ‹è¯•ä»¥éªŒè¯å“åº”æ—¥å¿—è®°å½•åŠŸèƒ½ï¼š

```bash
npm run test:response-logging
```

è¿™å°†åˆ›å»ºæ¨¡æ‹Ÿçš„è¯·æ±‚å“åº”æ—¥å¿—æ–‡ä»¶ï¼Œæµ‹è¯•è¯»å–ã€å…³è”å’ŒéªŒè¯åŠŸèƒ½ã€‚

## é…ç½®é€‰é¡¹

### ç”Ÿäº§ç¯å¢ƒï¼ˆæœ€å°æ—¥å¿—ï¼‰
```bash
export MDB_MCP_REQUEST_LOGGING_ENABLED=true
export MDB_MCP_REQUEST_LOGGING_RETENTION_DAYS=3
export MDB_MCP_REQUEST_LOGGING_INCLUDE_HEADERS=false
export MDB_MCP_REQUEST_LOGGING_INCLUDE_BODY=false
```

### å¼€å‘ç¯å¢ƒï¼ˆå®Œæ•´æ—¥å¿—ï¼‰
```bash
export MDB_MCP_REQUEST_LOGGING_ENABLED=true
export MDB_MCP_REQUEST_LOGGING_RETENTION_DAYS=7
export MDB_MCP_REQUEST_LOGGING_INCLUDE_HEADERS=true
export MDB_MCP_REQUEST_LOGGING_INCLUDE_BODY=true
export MDB_MCP_LOG_LEVEL=debug
``` 